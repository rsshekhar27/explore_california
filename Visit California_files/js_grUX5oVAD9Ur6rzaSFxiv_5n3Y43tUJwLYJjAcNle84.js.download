(function ($, Drupal, window, document, undefined) {

  Drupal.behaviors.navMain = {
    attach: function(context, settings) {
      var navMain = {
        config: {
          nav:         "#nav-main",
          trigger:     "#btn-nav-main, #btn-nav-search",
          fixElements: "body, #header .nav",
          duration:    250
        },

        init: function() {
          navMain.$nav           = $(navMain.config.nav);
          navMain.$trigger       = $(navMain.config.trigger);

          if (navMain.$nav.length && navMain.$trigger.length) {
            navMain.$nav.on("click", ".btn", navMain.clickHandler);
            navMain.$trigger.on("click", navMain.clickHandler);
          }
        },

        toggleNav: function($trigger) {
          var $body     = $("body"),
              $elements = $(navMain.config.fixElements);

          if (!$trigger || $trigger.is(".btn-retract")) {
            // Retract
            var rightPos = -navMain.$nav.innerWidth();

            navMain.$nav
              .removeClass("is-expanded")
              .stop().transit({
                right:    rightPos,
                duration: navMain.config.duration,
                complete: function() {
                  $elements.css({ width: "" });
                  $("html, body").removeClass("no-scroll");
                  navMain.$nav.css("right", "");
                }
              });

            navMain.toggleSubNav();

            $("#page").off("click", navMain.clickHandler);
            $(window).off("resize", navMain.resizeHandler);
          }
          else {
            // Expand
            $elements.css({ width: $body.innerWidth() });  // prevent content from shifting
            $("html, body").addClass("no-scroll");
            navMain.$nav
              .addClass("is-expanded")
              .stop().transit({
                right:    0,
                duration: navMain.config.duration
              });

            $("#page").one("click", navMain.clickHandler);
            $(window).one("resize", navMain.resizeHandler);
          }
        },

        toggleSubNav: function($trigger) {
          var $nav, rightPos;

          if ($trigger && $trigger.is(".btn-expand")) {
            // Expand
            $nav     = $trigger.next(".nav-sub");
            rightPos = 0;

            $nav.stop().transit({
              right: rightPos,
              duration: navMain.config.duration
            });
          }
          else {
            // Retract
            if ($trigger && $trigger.is(".btn-retract")) {
              $nav     = $trigger.closest(".nav-sub");
              rightPos = -$nav.innerWidth();
            }
            else {
              $nav     = navMain.$nav.find(".nav-sub");
              rightPos = -$nav.innerWidth();
            }

            $nav.stop().transit({
              right: rightPos,
              duration: navMain.config.duration,
              complete: function() {
                $nav.css("right", "");
              }
            });
          }
        },

        focusSearch: function() {
          navMain.$nav.find('.form-text:eq(0)').focus();
        },

        clickHandler: function(e) {
          var $target  = $(e.target);

          if ($target.closest(".btn-nav-sub").length) {
            navMain.toggleSubNav($target.closest(".btn"));
          }
          else if ($target.closest(".btn-expand").length || $target.closest(".btn-retract").length) {
            navMain.toggleNav($target.closest(".btn"));
          }
          else if ($target.closest("#page").length) {
            navMain.toggleNav();
          }

          if ($target.closest("#btn-nav-search").length) {
            navMain.focusSearch();
          }
        },

        resizeHandler: function(e) {
          $(navMain.config.fixElements).css({ width: "" });
        }
      };

      navMain.init();
    }
  };

})(jQuery, Drupal, this, this.document);;
(function ($, Drupal, window, document, undefined) {

  Drupal.behaviors.navRegion = {
    attach: function(context, settings) {
      var navRegion = {
        isAmimating: false,

        config: {
          nav:         "#nav-region",
          trigger:     "#btn-nav-region",
          fixElements: "body, #header .nav",
          duration:    250
        },

        init: function() {
          navRegion.$nav             = $(navRegion.config.nav);
          navRegion.$trigger         = $(navRegion.config.trigger);
          navRegion.$map             = navRegion.$nav.find(".map:eq(0)");
          navRegion.$regionItems     = navRegion.$nav.find(".item-region");
          navRegion.$btnRegionDetail = navRegion.$nav.find(".btn-region-detail");

          if (navRegion.$nav.length && navRegion.$trigger.length) {
            navRegion.$nav.on("click", ".btn", navRegion.clickHandler);
            navRegion.$trigger.on("click", navRegion.clickHandler);
            navRegion.$nav.on("mouseenter", ".btn", navRegion.mouseenterHandler);
            navRegion.$nav.on("mouseleave", ".btn", navRegion.mouseleaveHandler);
          }
        },

        toggleNav: function($trigger) {
          var $body     = $("body"),
              $elements = $(navRegion.config.fixElements);


          if (!$trigger || $trigger.is(".btn-retract")) {
            // Retract
            var rightPos = -navRegion.$nav.innerWidth();

            navRegion.$nav
              .removeClass("is-expanded")
              .stop().transit({
                right:    rightPos,
                duration: navRegion.config.duration,
                complete: function() {
                  $elements.css({ width: "" });
                  $("html, body").removeClass("no-scroll");
                  navRegion.$nav.css("right", "");
                  navRegion.$map.css({ height: "", width: "" });
                }
              });

              navRegion.toggleSubNav();

            $("#page").off("click", navRegion.clickHandler);
            $(window).off("resize", navRegion.resizeHandler);
          }
          else {
            // Expand
            $elements.css({ width: $body.innerWidth() });  // prevent content from shifting
            $("html, body").addClass("no-scroll");
            navRegion.$nav
              .addClass("is-expanded")
              .stop().transit({
                right:    0,
                duration: navRegion.config.duration
              });

            $("#page").one("click", navRegion.clickHandler);
            $(window).on("resize", navRegion.resizeHandler);
            navRegion.resizeMap();
          }
        },

        toggleSubNav: function($trigger) {
          var $subnav  = navRegion.$nav.find(".nav-sub:eq(0)");

          if (!$trigger || $trigger.is(".btn-retract")) {
            // Retract
            var rightPos = -navRegion.$nav.innerWidth();

            $subnav
              .removeClass("is-expanded")
              .stop().transit({
                right:    rightPos,
                duration: navRegion.config.duration,
                complete: function() {
                  $subnav.css("right", "");
                  // navRegion.$map.css({ height: "", width: "" });
                  navRegion.toggleDetail(null, 0);
                }
              });

            navRegion.$regionItems.removeClass("selected");
          }
          else {
            // Expand
            var $target = $($trigger.data("target"));

            if ($subnav.hasClass("is-expanded")) {
              navRegion.toggleDetail($target);
            }
            else {
              navRegion.toggleDetail($target, 0);

              $subnav
                .addClass("is-expanded")
                .stop().transit({
                  right:    0,
                  duration: navRegion.config.duration
                });
            }

            navRegion.$regionItems.each(function() {
              var $item    = $(this),
                  $current  = $item.find("[data-target='" + $trigger.data("target") + "']");

              $item.toggleClass("selected", $current.length > 0);
            });
          }
        },

        toggleDetail: function($target, duration) {
          var duration = typeof duration !== 'undefined' ? duration : navRegion.config.duration,
              rightPos = -navRegion.$nav.innerWidth();

          navRegion.isAmimating = true;

          // Retract all
          if ($target) {
            $target.siblings()
              .stop().transit({
                right:    rightPos,
                duration: duration,
                complete: function() {
                  $(this).css("right", "");
                }
              });

            $target
              .stop().transit({
                right:    0,
                duration: duration,
                complete: function() {
                  navRegion.isAmimating = false;
                }
              });
          }
          else {
            navRegion.$nav.find(".region-detail")
              .stop().transit({
                right:    rightPos,
                duration: duration,
                complete: function() {
                  $(this).css("right", "");
                  navRegion.isAmimating = false;
                }
              });
          }
        },

        toggleMapItem: function($trigger) {
          navRegion.$regionItems.removeClass("active");
          navRegion.$btnRegionDetail.removeClass("active");

          if ($trigger) {
            $trigger.addClass("active");

            var target = $trigger.data("target");
            navRegion.$regionItems.each(function() {
              var $regionItem = $(this),
                  $current    = $regionItem.find("[data-target='" + target + "']");

              if ($current.length) {
                $regionItem.addClass("active");

                return false;
              }
            });

            navRegion.$btnRegionDetail.filter("[data-target='" + target + "']").addClass("active");
          }
        },

        resizeMap: function() {
          var $map = navRegion.$map;

          if ($map.is(":visible")) {
            if (!$map.data("ratio")) {
              $map.data("ratio", $map.width() / $map.height());
            }

            var $window = $(window),
                ratio   = $map.data("ratio"),
                targetW = $window.width() - navRegion.$nav.find(".container-regions:eq(0)").innerWidth(),
                targetH = $window.height();

            if (targetW / targetH > ratio) {
              targetW = targetH * ratio;
            }
            else {
              targetH = (1 / ratio) * targetW;
            }

            $map.width(targetW).height(targetH);
          }
        },

        clickHandler: function(e) {
          if (!navRegion.isAmimating) {
            var $target  = $(e.target);

            if ($target.closest(".btn-nav-sub").length) {
              navRegion.toggleSubNav($target.closest(".btn"));
            }
            else if ($target.closest(".btn-expand").length || $target.closest(".btn-retract").length) {
              navRegion.toggleNav($target.closest(".btn"));
            }
            else if ($target.closest("#page").length) {
              navRegion.toggleNav();
            }
          }
        },

        resizeHandler: function(e) {
          $(navRegion.config.fixElements).css({ width: "" });

          navRegion.resizeMap();
        },

        mouseenterHandler: function(e) {
          var $target = $(e.target);

          if ($target.closest(".btn-region-detail").length) {
            navRegion.toggleMapItem($target.closest(".btn"));
          }
        },

        mouseleaveHandler: function(e) {
          var $target = $(e.target);

          if ($target.closest(".btn-region-detail").length) {
            navRegion.toggleMapItem();
          }
        }
      };

      navRegion.init();
    }
  };

})(jQuery, Drupal, this, this.document);;
(function ($) {

  Drupal.behaviors.vca_breaker_gallery = {
    attach: function (context, settings) {

      $('.field-name-field-gallery > .field-items').slick({
        dots: true,
        infinite: true,
        speed: 300,
        slidesToShow: 3,
        slidesToScroll: 1,
        responsive: [
          {
            breakpoint: 800,
            settings: {
              slidesToShow: 1,
              slidesToScroll: 1
            }
          }
        ]
      });

    }
  };

}(jQuery));
;
(function ($, Drupal, window, document, undefined) {

  Drupal.behaviors.circulation_modules = {
    attach: function(context, settings) {

      // initial screen check on page load, works for IE8
      // using https://github.com/benschwarz/matchMedia.js/tree/IE7-8
      if (matchMedia('screen and (max-width: 639px)').matches) {
        makeCarousel();
      }

      // add listener, will not work with ie9 or less
      if (!$('html').hasClass('lt-ie10') && !$('html').hasClass('lt-ie9')) {
        window.matchMedia('screen and (max-width: 639px)')
        .addListener(function(mql) {
          if (mql.matches) {
            makeCarousel();
          }
          else {
            destroyCarousel();
          }
        });
      }
    }
  };

  function makeCarousel() {
    // mobile widths use carousel
    $('.circulation-breaker-container').slick({
      dots: true,
      arrows: false,
      infinite: true,
      //speed: 500,
      slide: '.circulation-breaker-node',
      autoplay: false,
      autoplaySpeed: 5000
    });
    $('.circulation-footer-container').slick({
      dots: true,
      arrows: false,
      infinite: true,
      //speed: 500,
      slide: '.circulation-footer-node',
      autoplay: false,
      autoplaySpeed: 5000
    });
  }

  function destroyCarousel() {
    // turn off carousel for non-mobile widths
    if ($('.circulation-breaker-container').hasClass("slick-initialized")) {
      $('.circulation-breaker-container').unslick();
    }
    if ($('.circulation-footer-container').hasClass("slick-initialized")) {
      $('.circulation-footer-container').unslick();
    }
  }


})(jQuery, Drupal, this, this.document);
;
!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){"use strict";var b=window.Slick||{};b=function(){function c(c,d){var f,g,e=this;if(e.defaults={accessibility:!0,arrows:!0,autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(a,b){return'<button type="button">'+(b+1)+"</button>"},dots:!1,draggable:!0,easing:"linear",fade:!1,infinite:!0,lazyLoad:"ondemand",onBeforeChange:null,onAfterChange:null,onInit:null,onReInit:null,pauseOnHover:!0,responsive:null,slide:"div",slidesToShow:1,slidesToScroll:1,speed:300,swipe:!0,touchMove:!0,touchThreshold:5,vertical:!1},e.initials={animating:!1,autoPlayTimer:null,currentSlide:0,currentLeft:null,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,$list:null,touchObject:{},transformsEnabled:!1},a.extend(e,e.initials),e.activeBreakpoint=null,e.animType=null,e.animProp=null,e.breakpoints=[],e.breakpointSettings=[],e.cssTransitions=!1,e.paused=!1,e.positionProp=null,e.$slider=a(c),e.$slidesCache=null,e.transformType=null,e.transitionType=null,e.windowWidth=0,e.windowTimer=null,e.options=a.extend({},e.defaults,d),e.originalSettings=e.options,f=e.options.responsive||null,f&&f.length>-1){for(g in f)f.hasOwnProperty(g)&&(e.breakpoints.push(f[g].breakpoint),e.breakpointSettings[f[g].breakpoint]=f[g].settings);e.breakpoints.sort(function(a,b){return b-a})}e.autoPlay=a.proxy(e.autoPlay,e),e.autoPlayClear=a.proxy(e.autoPlayClear,e),e.changeSlide=a.proxy(e.changeSlide,e),e.setPosition=a.proxy(e.setPosition,e),e.swipeHandler=a.proxy(e.swipeHandler,e),e.dragHandler=a.proxy(e.dragHandler,e),e.keyHandler=a.proxy(e.keyHandler,e),e.autoPlayIterator=a.proxy(e.autoPlayIterator,e),e.instanceUid=b++,e.init()}var b=0;return c}(),b.prototype.addSlide=function(b,c,d){var e=this;if("boolean"==typeof c)d=c,c=null;else if(0>c||c>=e.slideCount)return!1;e.unload(),"number"==typeof c?0===c&&0===e.$slides.length?a(b).appendTo(e.$slideTrack):d?a(b).insertBefore(e.$slides.eq(c)):a(b).insertAfter(e.$slides.eq(c)):d===!0?a(b).prependTo(e.$slideTrack):a(b).appendTo(e.$slideTrack),e.$slides=e.$slideTrack.children(this.options.slide),e.$slideTrack.children(this.options.slide).remove(),e.$slideTrack.append(e.$slides),e.$slidesCache=e.$slides,e.reinit()},b.prototype.animateSlide=function(b,c){var d={},e=this;e.transformsEnabled===!1?e.options.vertical===!1?e.$slideTrack.animate({left:b},e.options.speed,e.options.easing,c):e.$slideTrack.animate({top:b},e.options.speed,e.options.easing,c):e.cssTransitions===!1?a({animStart:e.currentLeft}).animate({animStart:b},{duration:e.options.speed,easing:e.options.easing,step:function(a){e.options.vertical===!1?(d[e.animType]="translate("+a+"px, 0px)",e.$slideTrack.css(d)):(d[e.animType]="translate(0px,"+a+"px)",e.$slideTrack.css(d))},complete:function(){c&&c.call()}}):(e.applyTransition(),d[e.animType]=e.options.vertical===!1?"translate3d("+b+"px, 0px, 0px)":"translate3d(0px,"+b+"px, 0px)",e.$slideTrack.css(d),c&&setTimeout(function(){e.disableTransition(),c.call()},e.options.speed))},b.prototype.applyTransition=function(a){var b=this,c={};c[b.transitionType]=b.options.fade===!1?b.transformType+" "+b.options.speed+"ms "+b.options.cssEase:"opacity "+b.options.speed+"ms "+b.options.cssEase,b.options.fade===!1?b.$slideTrack.css(c):b.$slides.eq(a).css(c)},b.prototype.autoPlay=function(){var a=this;a.autoPlayTimer&&clearInterval(a.autoPlayTimer),a.slideCount>a.options.slidesToShow&&a.paused!==!0&&(a.autoPlayTimer=setInterval(a.autoPlayIterator,a.options.autoplaySpeed))},b.prototype.autoPlayClear=function(){var a=this;a.autoPlayTimer&&clearInterval(a.autoPlayTimer)},b.prototype.autoPlayIterator=function(){var a=this;a.options.infinite===!1?1===a.direction?(a.currentSlide+1===a.slideCount-1&&(a.direction=0),a.slideHandler(a.currentSlide+a.options.slidesToScroll)):(0===a.currentSlide-1&&(a.direction=1),a.slideHandler(a.currentSlide-a.options.slidesToScroll)):a.slideHandler(a.currentSlide+a.options.slidesToScroll)},b.prototype.buildArrows=function(){var b=this;b.options.arrows===!0&&b.slideCount>b.options.slidesToShow&&(b.$prevArrow=a('<button type="button" class="slick-prev">Previous</button>').appendTo(b.$slider),b.$nextArrow=a('<button type="button" class="slick-next">Next</button>').appendTo(b.$slider),b.options.infinite!==!0&&b.$prevArrow.addClass("slick-disabled"))},b.prototype.buildDots=function(){var c,d,b=this;if(b.options.dots===!0&&b.slideCount>b.options.slidesToShow){for(d='<ul class="slick-dots">',c=0;c<=b.getDotCount();c+=1)d+="<li>"+b.options.customPaging.call(this,b,c)+"</li>";d+="</ul>",b.$dots=a(d).appendTo(b.$slider),b.$dots.find("li").first().addClass("slick-active")}},b.prototype.buildOut=function(){var b=this;b.$slides=b.$slider.children(b.options.slide+":not(.slick-cloned)").addClass("slick-slide"),b.slideCount=b.$slides.length,b.$slidesCache=b.$slides,b.$slider.addClass("slick-slider"),b.$slideTrack=0===b.slideCount?a('<div class="slick-track"/>').appendTo(b.$slider):b.$slides.wrapAll('<div class="slick-track"/>').parent(),b.$list=b.$slideTrack.wrap('<div class="slick-list"/>').parent(),b.$slideTrack.css("opacity",0),b.options.centerMode===!0&&(b.options.infinite=!0,b.options.slidesToScroll=1,0===b.options.slidesToShow%2&&(b.options.slidesToShow=3)),a("img[data-lazy]",b.$slider).not("[src]").addClass("slick-loading"),b.setupInfinite(),b.buildArrows(),b.buildDots(),b.options.accessibility===!0&&b.$list.prop("tabIndex",0),b.setSlideClasses(0),b.options.draggable===!0&&b.$list.addClass("draggable")},b.prototype.checkResponsive=function(){var c,d,b=this;if(b.originalSettings.responsive&&b.originalSettings.responsive.length>-1&&null!==b.originalSettings.responsive){d=null;for(c in b.breakpoints)b.breakpoints.hasOwnProperty(c)&&a(window).width()<b.breakpoints[c]&&(d=b.breakpoints[c]);null!==d?null!==b.activeBreakpoint?d!==b.activeBreakpoint&&(b.activeBreakpoint=d,b.options=a.extend({},b.defaults,b.breakpointSettings[d]),b.refresh()):(b.activeBreakpoint=d,b.options=a.extend({},b.defaults,b.breakpointSettings[d]),b.refresh()):null!==b.activeBreakpoint&&(b.activeBreakpoint=null,b.options=a.extend({},b.defaults,b.originalSettings),b.refresh())}},b.prototype.changeSlide=function(b){var c=this;switch(b.data.message){case"previous":c.slideHandler(c.currentSlide-c.options.slidesToScroll);break;case"next":c.slideHandler(c.currentSlide+c.options.slidesToScroll);break;case"index":c.slideHandler(a(b.target).parent().index()*c.options.slidesToScroll);break;default:return!1}},b.prototype.destroy=function(){var b=this;b.autoPlayClear(),b.touchObject={},a(".slick-cloned",b.$slider).remove(),b.$dots&&b.$dots.remove(),b.$prevArrow&&(b.$prevArrow.remove(),b.$nextArrow.remove()),b.$slides.unwrap().unwrap(),b.$slides.removeClass("slick-slide slick-active slick-visible").removeAttr("style"),b.$slider.removeClass("slick-slider"),b.$slider.removeClass("slick-initialized"),b.$list.off(".slick"),a(window).off(".slick-"+b.instanceUid)},b.prototype.disableTransition=function(a){var b=this,c={};c[b.transitionType]="",b.options.fade===!1?b.$slideTrack.css(c):b.$slides.eq(a).css(c)},b.prototype.fadeSlide=function(a,b){var c=this;c.cssTransitions===!1?(c.$slides.eq(a).css({zIndex:1e3}),c.$slides.eq(a).animate({opacity:1},c.options.speed,c.options.easing,b)):(c.applyTransition(a),c.$slides.eq(a).css({opacity:1,zIndex:1e3}),b&&setTimeout(function(){c.disableTransition(a),b.call()},c.options.speed))},b.prototype.filterSlides=function(a){var b=this;null!==a&&(b.unload(),b.$slideTrack.children(this.options.slide).remove(),b.$slidesCache.filter(a).appendTo(b.$slideTrack),b.reinit())},b.prototype.getDotCount=function(){var e,a=this,b=0,c=0,d=0;for(e=a.options.infinite===!0?a.slideCount+a.options.slidesToShow-a.options.slidesToScroll:a.slideCount;e>b;)d++,c+=a.options.slidesToScroll,b=c+a.options.slidesToShow;return d},b.prototype.getLeft=function(a){var c,b=this;return b.slideOffset=0,b.options.infinite===!0?(b.slideCount>b.options.slidesToShow&&(b.slideOffset=-1*b.slideWidth*b.options.slidesToShow),0!==b.slideCount%b.options.slidesToScroll&&a+b.options.slidesToScroll>b.slideCount&&b.slideCount>b.options.slidesToShow&&(b.slideOffset=-1*b.slideCount%b.options.slidesToShow*b.slideWidth)):0!==b.slideCount%b.options.slidesToShow&&a+b.options.slidesToScroll>b.slideCount&&b.slideCount>b.options.slidesToShow&&(b.slideOffset=b.slideCount%b.options.slidesToShow*b.slideWidth),b.options.centerMode===!0&&(b.slideOffset+=b.slideWidth*Math.floor(b.options.slidesToShow/2)-b.slideWidth),b.options.vertical===!1?c=-1*a*b.slideWidth+b.slideOffset:(b.listHeight=b.$list.height(),c=b.options.infinite===!0?-1*a*b.listHeight-b.listHeight:-1*a*b.listHeight),c},b.prototype.init=function(){var b=this;a(b.$slider).hasClass("slick-initialized")||(a(b.$slider).addClass("slick-initialized"),b.buildOut(),b.setProps(),b.startLoad(),b.loadSlider(),b.initializeEvents(),b.checkResponsive()),null!==b.options.onInit&&b.options.onInit.call(this,b)},b.prototype.initArrowEvents=function(){var a=this;a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.on("click.slick",{message:"previous"},a.changeSlide),a.$nextArrow.on("click.slick",{message:"next"},a.changeSlide))},b.prototype.initDotEvents=function(){var b=this;b.options.dots===!0&&b.slideCount>b.options.slidesToShow&&a("li",b.$dots).on("click.slick",{message:"index"},b.changeSlide)},b.prototype.initializeEvents=function(){var b=this;b.initArrowEvents(),b.initDotEvents(),b.$list.on("touchstart.slick mousedown.slick",{action:"start"},b.swipeHandler),b.$list.on("touchmove.slick mousemove.slick",{action:"move"},b.swipeHandler),b.$list.on("touchend.slick mouseup.slick",{action:"end"},b.swipeHandler),b.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},b.swipeHandler),b.options.pauseOnHover===!0&&b.options.autoplay===!0&&(b.$list.on("mouseenter.slick",b.autoPlayClear),b.$list.on("mouseleave.slick",b.autoPlay)),b.options.accessibility===!0&&b.$list.on("keydown.slick",b.keyHandler),a(window).on("orientationchange.slick.slick-"+b.instanceUid,function(){b.checkResponsive(),b.setPosition()}),a(window).on("resize.slick.slick-"+b.instanceUid,function(){a(window).width!==b.windowWidth&&(clearTimeout(b.windowDelay),b.windowDelay=window.setTimeout(function(){b.windowWidth=a(window).width(),b.checkResponsive(),b.setPosition()},50))}),a(window).on("load.slick.slick-"+b.instanceUid,b.setPosition)},b.prototype.initUI=function(){var a=this;a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.show(),a.$nextArrow.show()),a.options.dots===!0&&a.slideCount>a.options.slidesToShow&&a.$dots.show(),a.options.autoplay===!0&&a.autoPlay()},b.prototype.keyHandler=function(a){var b=this;37===a.keyCode?b.changeSlide({data:{message:"previous"}}):39===a.keyCode&&b.changeSlide({data:{message:"next"}})},b.prototype.lazyLoad=function(){var c,d,e,f,b=this;b.options.centerMode===!0?(e=b.options.slidesToShow+b.currentSlide-1,f=e+b.options.slidesToShow+2):(e=b.options.infinite?b.options.slidesToShow+b.currentSlide:b.currentSlide,f=e+b.options.slidesToShow),c=b.$slider.find(".slick-slide").slice(e,f),a("img[data-lazy]",c).not("[src]").each(function(){a(this).css({opacity:0}).attr("src",a(this).attr("data-lazy")).removeClass("slick-loading").load(function(){a(this).animate({opacity:1},200)})}),b.currentSlide>=b.slideCount-b.options.slidesToShow?(d=b.$slider.find(".slick-cloned").slice(0,b.options.slidesToShow),a("img[data-lazy]",d).not("[src]").each(function(){a(this).css({opacity:0}).attr("src",a(this).attr("data-lazy")).removeClass("slick-loading").load(function(){a(this).animate({opacity:1},200)})})):0===b.currentSlide&&(d=b.$slider.find(".slick-cloned").slice(-1*b.options.slidesToShow),a("img[data-lazy]",d).not("[src]").each(function(){a(this).css({opacity:0}).attr("src",a(this).attr("data-lazy")).removeClass("slick-loading").load(function(){a(this).animate({opacity:1},200)})}))},b.prototype.loadSlider=function(){var a=this;a.setPosition(),a.$slideTrack.css({opacity:1}),a.$slider.removeClass("slick-loading"),a.initUI(),"progressive"===a.options.lazyLoad&&a.progressiveLazyLoad()},b.prototype.postSlide=function(a){var b=this;null!==b.options.onAfterChange&&b.options.onAfterChange.call(this,b,a),b.animating=!1,b.setPosition(),b.swipeLeft=null,b.options.autoplay===!0&&b.paused===!1&&b.autoPlay(),b.setSlideClasses(b.currentSlide)},b.prototype.progressiveLazyLoad=function(){var c,d,b=this;c=a("img[data-lazy]").not("[src]").length,c>0&&(d=a(a("img[data-lazy]",b.$slider).not("[src]").get(0)),d.attr("src",d.attr("data-lazy")).removeClass("slick-loading").load(function(){b.progressiveLazyLoad()}))},b.prototype.refresh=function(){var b=this;b.destroy(),a.extend(b,b.initials),b.init()},b.prototype.reinit=function(){var b=this;b.$slides=a(b.options.slide+":not(.slick-cloned)",b.$slideTrack).addClass("slick-slide"),b.slideCount=b.$slides.length,b.currentSlide>=b.slideCount&&0!==b.currentSlide&&(b.currentSlide=b.currentSlide-b.options.slidesToScroll),b.setProps(),b.setupInfinite(),b.buildArrows(),b.updateArrows(),b.initArrowEvents(),b.buildDots(),b.updateDots(),b.initDotEvents(),b.setSlideClasses(0),b.setPosition(),null!==b.options.onReInit&&b.options.onReInit.call(this,b)},b.prototype.removeSlide=function(a,b){var c=this;return"boolean"==typeof a?(b=a,a=b===!0?0:c.slideCount-1):a=b===!0?--a:a,c.slideCount<1||0>a||a>c.slideCount-1?!1:(c.unload(),c.$slideTrack.children(this.options.slide).eq(a).remove(),c.$slides=c.$slideTrack.children(this.options.slide),c.$slideTrack.children(this.options.slide).remove(),c.$slideTrack.append(c.$slides),c.$slidesCache=c.$slides,c.reinit(),void 0)},b.prototype.setCSS=function(a){var d,e,b=this,c={};d="left"==b.positionProp?a+"px":"0px",e="top"==b.positionProp?a+"px":"0px",c[b.positionProp]=a,b.transformsEnabled===!1?b.$slideTrack.css(c):(c={},b.cssTransitions===!1?(c[b.animType]="translate("+d+", "+e+")",b.$slideTrack.css(c)):(c[b.animType]="translate3d("+d+", "+e+", 0px)",b.$slideTrack.css(c)))},b.prototype.setDimensions=function(){var a=this;a.options.centerMode===!0?a.$slideTrack.children(".slick-slide").width(a.slideWidth):a.$slideTrack.children(".slick-slide").width(a.slideWidth),a.options.vertical===!1?(a.$slideTrack.width(Math.ceil(a.slideWidth*a.$slideTrack.children(".slick-slide").length)),a.options.centerMode===!0&&a.$list.css({padding:"0px "+a.options.centerPadding})):(a.$list.height(a.$slides.first().outerHeight()),a.$slideTrack.height(Math.ceil(a.listHeight*a.$slideTrack.children(".slick-slide").length)),a.options.centerMode===!0&&a.$list.css({padding:a.options.centerPadding+" 0px"}))},b.prototype.setFade=function(){var c,b=this;b.$slides.each(function(d,e){c=-1*b.slideWidth*d,a(e).css({position:"relative",left:c,top:0,zIndex:800,opacity:0})}),b.$slides.eq(b.currentSlide).css({zIndex:900,opacity:1})},b.prototype.setPosition=function(){var a=this;a.setValues(),a.setDimensions(),a.options.fade===!1?a.setCSS(a.getLeft(a.currentSlide)):a.setFade()},b.prototype.setProps=function(){var a=this;a.positionProp=a.options.vertical===!0?"top":"left","top"===a.positionProp?a.$slider.addClass("slick-vertical"):a.$slider.removeClass("slick-vertical"),(void 0!==document.body.style.WebkitTransition||void 0!==document.body.style.MozTransition||void 0!==document.body.style.msTransition)&&(a.cssTransitions=!0),void 0!==document.body.style.MozTransform&&(a.animType="MozTransform",a.transformType="-moz-transform",a.transitionType="MozTransition"),void 0!==document.body.style.webkitTransform&&(a.animType="webkitTransform",a.transformType="-webkit-transform",a.transitionType="webkitTransition"),void 0!==document.body.style.msTransform&&(a.animType="transform",a.transformType="transform",a.transitionType="transition"),a.transformsEnabled=null!==a.animType},b.prototype.setValues=function(){var a=this;a.listWidth=a.$list.width(),a.listHeight=a.$list.height(),a.slideWidth=Math.ceil(a.listWidth/a.options.slidesToShow)},b.prototype.setSlideClasses=function(a){var c,d,e,b=this;b.$slider.find(".slick-slide").removeClass("slick-active").removeClass("slick-center"),d=b.$slider.find(".slick-slide"),b.options.centerMode===!0?(c=Math.floor(b.options.slidesToShow/2),a>=c&&a<=b.slideCount-1-c?b.$slides.slice(a-c,a+c+1).addClass("slick-active"):(e=b.options.slidesToShow+a,d.slice(e-c+1,e+c+2).addClass("slick-active")),0===a?d.eq(d.length-1-b.options.slidesToShow).addClass("slick-center"):a===b.slideCount-1&&d.eq(b.options.slidesToShow).addClass("slick-center"),b.$slides.eq(a).addClass("slick-center")):a>0&&a<b.slideCount-b.options.slidesToShow?b.$slides.slice(a,a+b.options.slidesToShow).addClass("slick-active"):(e=b.options.slidesToShow+a,d.slice(e,e+b.options.slidesToShow).addClass("slick-active")),"ondemand"===b.options.lazyLoad&&b.lazyLoad()},b.prototype.setupInfinite=function(){var c,d,e,b=this;if((b.options.fade===!0||b.options.vertical===!0)&&(b.options.slidesToShow=1,b.options.slidesToScroll=1,b.options.centerMode=!1),b.options.infinite===!0&&b.options.fade===!1&&(d=null,b.slideCount>b.options.slidesToShow)){for(e=b.options.centerMode===!0?b.options.slidesToShow+1:b.options.slidesToShow,c=b.slideCount;c>b.slideCount-e;c-=1)d=c-1,a(b.$slides[d]).clone().attr("id","").prependTo(b.$slideTrack).addClass("slick-cloned");for(c=0;e>c;c+=1)d=c,a(b.$slides[d]).clone().attr("id","").appendTo(b.$slideTrack).addClass("slick-cloned");b.$slideTrack.find(".slick-cloned").find("[id]").each(function(){a(this).attr("id","")})}},b.prototype.slideHandler=function(a){var b,c,d,e,f=null,g=this;return g.animating===!0?!1:(b=a,f=g.getLeft(b),d=g.getLeft(g.currentSlide),e=0!==g.slideCount%g.options.slidesToScroll?g.options.slidesToScroll:0,g.currentLeft=null===g.swipeLeft?d:g.swipeLeft,g.options.infinite===!1&&(0>a||a>g.slideCount-g.options.slidesToShow+e)?(b=g.currentSlide,g.animateSlide(d,function(){g.postSlide(b)}),!1):(g.options.autoplay===!0&&clearInterval(g.autoPlayTimer),c=0>b?0!==g.slideCount%g.options.slidesToScroll?g.slideCount-g.slideCount%g.options.slidesToScroll:g.slideCount-g.options.slidesToScroll:b>g.slideCount-1?0:b,g.animating=!0,null!==g.options.onBeforeChange&&a!==g.currentSlide&&g.options.onBeforeChange.call(this,g,g.currentSlide,c),g.currentSlide=c,g.updateDots(),g.updateArrows(),g.options.fade===!0?(g.fadeSlide(c,function(){g.postSlide(c)}),!1):(g.animateSlide(f,function(){g.postSlide(c)}),void 0)))},b.prototype.startLoad=function(){var a=this;a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.hide(),a.$nextArrow.hide()),a.options.dots===!0&&a.slideCount>a.options.slidesToShow&&a.$dots.hide(),a.$slider.addClass("slick-loading")},b.prototype.swipeDirection=function(){var a,b,c,d,e=this;return a=e.touchObject.startX-e.touchObject.curX,b=e.touchObject.startY-e.touchObject.curY,c=Math.atan2(b,a),d=Math.round(180*c/Math.PI),0>d&&(d=360-Math.abs(d)),45>=d&&d>=0?"left":360>=d&&d>=315?"left":d>=135&&225>=d?"right":"vertical"},b.prototype.swipeEnd=function(b){var c=this;if(c.$list.removeClass("dragging"),void 0===c.touchObject.curX)return!1;if(c.touchObject.swipeLength>=c.touchObject.minSwipe)switch(a(b.target).on("click.slick",function(b){b.stopImmediatePropagation(),b.stopPropagation(),b.preventDefault(),a(b.target).off("click.slick")}),c.swipeDirection()){case"left":c.slideHandler(c.currentSlide+c.options.slidesToScroll),c.touchObject={};break;case"right":c.slideHandler(c.currentSlide-c.options.slidesToScroll),c.touchObject={}}else c.touchObject.startX!==c.touchObject.curX&&(c.slideHandler(c.currentSlide),c.touchObject={})},b.prototype.swipeHandler=function(a){var b=this;if("ontouchend"in document&&b.options.swipe===!1)return!1;if(b.options.draggable===!1&&!a.originalEvent.touches)return!1;switch(b.touchObject.fingerCount=a.originalEvent&&void 0!==a.originalEvent.touches?a.originalEvent.touches.length:1,b.touchObject.minSwipe=b.listWidth/b.options.touchThreshold,a.data.action){case"start":b.swipeStart(a);break;case"move":b.swipeMove(a);break;case"end":b.swipeEnd(a)}},b.prototype.swipeMove=function(a){var c,d,e,f,b=this;return f=void 0!==a.originalEvent?a.originalEvent.touches:null,c=b.getLeft(b.currentSlide),!b.$list.hasClass("dragging")||f&&1!==f.length?!1:(b.touchObject.curX=void 0!==f?f[0].pageX:a.clientX,b.touchObject.curY=void 0!==f?f[0].pageY:a.clientY,b.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(b.touchObject.curX-b.touchObject.startX,2))),d=b.swipeDirection(),"vertical"!==d?(void 0!==a.originalEvent&&b.touchObject.swipeLength>4&&a.preventDefault(),e=b.touchObject.curX>b.touchObject.startX?1:-1,b.swipeLeft=b.options.vertical===!1?c+b.touchObject.swipeLength*e:c+b.touchObject.swipeLength*(b.listHeight/b.listWidth)*e,b.options.fade===!0||b.options.touchMove===!1?!1:b.animating===!0?(b.swipeLeft=null,!1):(b.setCSS(b.swipeLeft),void 0)):void 0)},b.prototype.swipeStart=function(a){var c,b=this;return 1!==b.touchObject.fingerCount||b.slideCount<=b.options.slidesToShow?(b.touchObject={},!1):(void 0!==a.originalEvent&&void 0!==a.originalEvent.touches&&(c=a.originalEvent.touches[0]),b.touchObject.startX=b.touchObject.curX=void 0!==c?c.pageX:a.clientX,b.touchObject.startY=b.touchObject.curY=void 0!==c?c.pageY:a.clientY,b.$list.addClass("dragging"),void 0)},b.prototype.unfilterSlides=function(){var a=this;null!==a.$slidesCache&&(a.unload(),a.$slideTrack.children(this.options.slide).remove(),a.$slidesCache.appendTo(a.$slideTrack),a.reinit())},b.prototype.unload=function(){var b=this;a(".slick-cloned",b.$slider).remove(),b.$dots&&b.$dots.remove(),b.$prevArrow&&(b.$prevArrow.remove(),b.$nextArrow.remove()),b.$slides.removeClass("slick-slide slick-active slick-visible").removeAttr("style")},b.prototype.updateArrows=function(){var a=this;a.options.arrows===!0&&a.options.infinite!==!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.removeClass("slick-disabled"),a.$nextArrow.removeClass("slick-disabled"),0===a.currentSlide?(a.$prevArrow.addClass("slick-disabled"),a.$nextArrow.removeClass("slick-disabled")):a.currentSlide>=a.slideCount-a.options.slidesToShow&&(a.$nextArrow.addClass("slick-disabled"),a.$prevArrow.removeClass("slick-disabled")))},b.prototype.updateDots=function(){var a=this;null!==a.$dots&&(a.$dots.find("li").removeClass("slick-active"),a.$dots.find("li").eq(a.currentSlide/a.options.slidesToScroll).addClass("slick-active"))},a.fn.slick=function(a){var c=this;return c.each(function(c,d){d.slick=new b(d,a)})},a.fn.slickAdd=function(a,b,c){var d=this;return d.each(function(d,e){e.slick.addSlide(a,b,c)})},a.fn.slickFilter=function(a){var b=this;return b.each(function(b,c){c.slick.filterSlides(a)})},a.fn.slickGoTo=function(a){var b=this;return b.each(function(b,c){c.slick.slideHandler(a)})},a.fn.slickNext=function(){var a=this;return a.each(function(a,b){b.slick.changeSlide({data:{message:"next"}})})},a.fn.slickPause=function(){var a=this;return a.each(function(a,b){b.slick.autoPlayClear(),b.slick.paused=!0})},a.fn.slickPlay=function(){var a=this;return a.each(function(a,b){b.slick.paused=!1,b.slick.autoPlay()})},a.fn.slickPrev=function(){var a=this;return a.each(function(a,b){b.slick.changeSlide({data:{message:"previous"}})})},a.fn.slickRemove=function(a,b){var c=this;return c.each(function(c,d){d.slick.removeSlide(a,b)})},a.fn.slickSetOption=function(a,b,c){var d=this;return d.each(function(d,e){e.slick.options[a]=b,c===!0&&(e.slick.unload(),e.slick.reinit())})},a.fn.slickUnfilter=function(){var a=this;return a.each(function(a,b){b.slick.unfilterSlides()})},a.fn.unslick=function(){var a=this;return a.each(function(a,b){b.slick.destroy()})}});;
/**
 * @file views_load_more.js
 *
 * Handles the AJAX pager for the view_load_more plugin.
 */
(function ($) {

  /**
   * Provide a series of commands that the server can request the client perform.
   */
  Drupal.ajax.prototype.commands.viewsLoadMoreAppend = function (ajax, response, status) {
    // Get information from the response. If it is not there, default to
    // our presets.
    var wrapper = response.selector ? $(response.selector) : $(ajax.wrapper);
    var method = response.method || ajax.method;
    var targetList = response.targetList || '';
    var effect = ajax.getEffect(response);
    var pager_selector = response.options.pager_selector ? response.options.pager_selector : '.pager-load-more';

    // We don't know what response.data contains: it might be a string of text
    // without HTML, so don't rely on jQuery correctly iterpreting
    // $(response.data) as new HTML rather than a CSS selector. Also, if
    // response.data contains top-level text nodes, they get lost with either
    // $(response.data) or $('<div></div>').replaceWith(response.data).
    var new_content_wrapped = $('<div></div>').html(response.data);
    var new_content = new_content_wrapped.contents();

    // For legacy reasons, the effects processing code assumes that new_content
    // consists of a single top-level element. Also, it has not been
    // sufficiently tested whether attachBehaviors() can be successfully called
    // with a context object that includes top-level text nodes. However, to
    // give developers full control of the HTML appearing in the page, and to
    // enable Ajax content to be inserted in places where DIV elements are not
    // allowed (e.g., within TABLE, TR, and SPAN parents), we check if the new
    // content satisfies the requirement of a single top-level element, and
    // only use the container DIV created above when it doesn't. For more
    // information, please see http://drupal.org/node/736066.
    if (new_content.length != 1 || new_content.get(0).nodeType != 1) {
      new_content = new_content_wrapped;
    }
    // If removing content from the wrapper, detach behaviors first.
    var settings = response.settings || ajax.settings || Drupal.settings;
    Drupal.detachBehaviors(wrapper, settings);
    if ($.waypoints != undefined) {
      $.waypoints('refresh');
    }

    // Set up our default query options. This is for advance users that might
    // change there views layout classes. This allows them to write there own
    // jquery selector to replace the content with.
    // Provide sensible defaults for unordered list, ordered list and table
    // view styles.
    var content_query = targetList && !response.options.content ? '> .view-content ' + targetList : response.options.content || '> .view-content';

    // If we're using any effects. Hide the new content before adding it to the DOM.
    if (effect.showEffect != 'show') {
      new_content.find(content_query).children().hide();
    }

    // Update the pager
    // Find both for the wrapper as the newly loaded content the direct child
    // .item-list in case of nested pagers
    wrapper.find(pager_selector).replaceWith(new_content.find(pager_selector));

    // Add the new content to the page.
    wrapper.find(content_query)[method](new_content.find(content_query).children());

    // Re-class the loaded content.
    // @todo this is faulty in many ways.  first of which is that user may have configured view to not have these classes at all.
    wrapper.find(content_query).children()
      .removeClass('views-row-first views-row-last views-row-odd views-row-even')
      .filter(':first')
        .addClass('views-row-first')
        .end()
      .filter(':last')
        .addClass('views-row-last')
        .end()
      .filter(':even')
        .addClass('views-row-odd')
        .end()
      .filter(':odd')
        .addClass('views-row-even')
        .end();

    if (effect.showEffect != 'show') {
      wrapper.find(content_query).children(':not(:visible)')[effect.showEffect](effect.showSpeed);
    }

    // Additional processing over new content
    wrapper.trigger('views_load_more.new_content', new_content.clone());

    // Attach all JavaScript behaviors to the new content
    // Remove the Jquery once Class, TODO: There needs to be a better
    // way of doing this, look at .removeOnce() :-/
    var classes = wrapper.attr('class');
    var onceClass = classes.match(/jquery-once-[0-9]*-[a-z]*/);
    wrapper.removeClass(onceClass[0]);
    settings = response.settings || ajax.settings || Drupal.settings;
    Drupal.attachBehaviors(wrapper, settings);
  };

  /**
   * Attaches the AJAX behavior to Views Load More waypoint support.
   */
  Drupal.behaviors.ViewsLoadMore = {
    attach: function (context, settings) {
      var default_opts = {
          offset: '100%'
        };

      if (settings && settings.viewsLoadMore && settings.views && settings.views.ajaxViews) {
        $.each(settings.viewsLoadMore, function(i, setting) {
          var view = '.view-id-' + setting.view_name + '.view-display-id-' + setting.view_display_id + ' .pager-next a',
            opts = {};

          $.extend(opts, default_opts, settings.viewsLoadMore[i].opts);

          $(view).waypoint('destroy');
          $(view).waypoint(function(event, direction) {
            $(view).click();
          }, opts);
        });
      }
    },
    detach: function (context, settings, trigger) {
      if (settings && settings.viewsLoadMore && settings.views && settings.views.ajaxViews) {
        $.each(settings.viewsLoadMore, function(i, setting) {
          var view = '.view-id-' + setting.view_name + '.view-display-id-' + setting.view_display_id;
          if ($(context).is(view)) {
            $('.pager-next a', view).waypoint('destroy');
          }
          else {
            $(view, context).waypoint('destroy');
          }
        });
      }
    }
  };
})(jQuery);
;
(function ($, Drupal, window, document, undefined) {

  Drupal.behaviors.modal = {
    attach: function(context, settings) {
      var modal = {
        config: {
          duration: 500
        },

        init: function() {
          modal.$items = $("[data-modal]");

          if (modal.$items.length > 0) {
            modal.$modal = modal.createModal();
            modal.$modal.once('jquery-once-modal-click').on("click", ".modal-close", modal.hideModal);
            modal.$items.once('jquery-once-modal-click').on("click", modal.showModal);
          }
        },

        createModal: function() {
          var $modal = $("<div>")
            .attr("class", "modal")
            .appendTo("body");

          var $content = $("<div>")
            .addClass("modal-content")
            .appendTo($modal);

          var $button = $("<button>")
            .addClass("modal-close")
            .appendTo($modal);
          
          return $modal;
        },

        showModal: function() {
          var content = $($(this).data("modal")).html().replace("data-src", "src");

          modal.$modal
            .find(".modal-content:eq(0)")
            .html(content);

          modal.$modal.fadeIn(modal.config.duration);

          $("body").addClass("no-scroll");

          $(document).on("keydown", modal.keydownHandler);
        },

        hideModal: function() {
          modal.$modal.fadeOut(modal.config.duration, function() {
            modal.$modal
              .find(".modal-content:eq(0)")
              .html("");

            $("body").removeClass("no-scroll");
          });

          $(document).off("keydown", modal.keydownHandler);
        },

        keydownHandler: function(e) {
          if (e.keyCode == "27") {
            modal.hideModal();
          }
        }
      };

      modal.init();
    }
  };

})(jQuery, Drupal, this, this.document);
;
/**
 * @file
 * VCAL Event Tracking.
 */
(function ($) {

  /**
   * Dream 365 TV Analytics Object.
   */
  Drupal.dream365VideoAnalytics = {
    interval: 0,
    isStartEventFired: false,
    is50PercentEventFired: false,
    title: '',

    youTubeStateChangeHandler: function(e) {
      var videoData  = e.target.getVideoData();

      if (Drupal.dream365VideoAnalytics.interval) {
        clearInterval(Drupal.dream365VideoAnalytics.interval);
        interval = 0;
      }

      switch (e.data) {
        // Video Ended.
        case YT.PlayerState.ENDED:
          Drupal.dream365VideoAnalytics.isStartEventFired     = false;
          Drupal.dream365VideoAnalytics.is50PercentEventFired = false;
          Drupal.dream365VideoAnalytics.interval = 0;
          interval = 0;

          $('.video-message:eq(0)').addClass('active');

          // Send GA Message.
          ga('send', 'event', 'Video Playback', '100% Complete', videoData.title);
          break;

        // Video Playing.
        case YT.PlayerState.BUFFERING:
          Drupal.dream365VideoAnalytics.isStartEventFired = true;
          ga('send', 'event', 'Video Playback', 'Start', videoData.title);

          break;
        case YT.PlayerState.PLAYING:
          Drupal.dream365VideoAnalytics.interval = setInterval(function() {
            var currentTime = e.target.getCurrentTime(),
                totalTime   = e.target.getDuration(),
                percent     = currentTime / totalTime;

            if (percent > 0 && !Drupal.dream365VideoAnalytics.isStartEventFired) {
              Drupal.dream365VideoAnalytics.isStartEventFired = true;
              ga('send', 'event', 'Video Playback', 'Start', videoData.title);
            }

            if (percent > 0.5 && !Drupal.dream365VideoAnalytics.is50PercentEventFired) {
              Drupal.dream365VideoAnalytics.is50PercentEventFired = true;
              ga('send', 'event', 'Video Playback', '50% Complete', videoData.title);
            }
          }, 100);

          break;
      }
    },

    vimeoPlayProgressHandler: function(e) {
      if (e.percent > 0 && !Drupal.dream365VideoAnalytics.isStartEventFired) {
        Drupal.dream365VideoAnalytics.isStartEventFired = true;

        ga('send', 'event', 'Video Playback', 'Start', Drupal.dream365VideoAnalytics.title);
      }

      if (e.percent > 0.5 && !Drupal.dream365VideoAnalytics.is50PercentEventFired) {
        Drupal.dream365VideoAnalytics.is50PercentEventFired = true;

        ga('send', 'event', 'Video Playback', '50% Complete', Drupal.dream365VideoAnalytics.title);
      }
    },

    vimeoFinishHandler: function(e) {
      Drupal.dream365VideoAnalytics.isStartEventFired     = false;
      Drupal.dream365VideoAnalytics.is50PercentEventFired = false;

      ga('send', 'event', 'Video Playback', '100% Complete', Drupal.dream365VideoAnalytics.title);

      $('.video-message:eq(0)').addClass('active');
    }
  };

  /**
   * Dream 365 TV Event Tracking.
   */
  Drupal.behaviors.eventTrackingDream365 = {
    attach: function (context, settings) {
      if (typeof ga == 'undefined') {
        return;
      }

      // Click handler for share buttons
      $('.d365tv-video-sharing .addthis_toolbox a', context).bind('click', function(e) {

        if ($(this).hasClass('addthis_button_facebook')) {
          ga('send', 'event', 'Content Share', 'Facebook')
        }
        else if ($(this).hasClass('addthis_button_google_plusone_share')) {
          ga('send', 'event', 'Content Share', 'Google+')
        }
        else if ($(this).hasClass('addthis_button_twitter')) {
          ga('send', 'event', 'Content Share', 'Twitter')
        }
        else if ($(this).hasClass('addthis_button_email')) {
          ga('send', 'event', 'Content Share', 'Email')
        }
      });
    }
  };

  /**
   * Page Scroll Events.
   */
  Drupal.behaviors.eventTrackingPageScroll = {
    attach: function (context, settings) {
      if (typeof ga == 'undefined') {
        return;
      }

      // Page Scroll.
      $('body').once('jquery-once-track-page-scroll', function() {
        // Scroll event.
        $(window).scroll(function() {
          if (gaPageScrollGetPosition() > gaPageScrollTarget && gaPageScrollNum == 1) {
            ga('send', 'event', 'Page Scroll', 'Full Page', undefined, undefined, {'nonInteraction': 1});
            gaPageScrollTarget += gaPageScrollWindowHeight;
            gaPageScrollNum++;
          }
        });

        // Resize event.
        $(window).resize(function() {
          gaPageScrollWindowHeight = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          gaPageScrollTarget       = gaPageScrollGetPosition() + gaPageScrollWindowHeight;
        });
      });

    }
  };

  /**
   * Content module events.
   */
  Drupal.behaviors.eventTrackingContentModules = {
    attach: function(context, settings) {
      if (typeof ga == 'undefined') {
        return;
      }

      // Track outbound link
      // Fire event when link to external site is clicked.
      // Pass link URL into event.
      $('body', context).once('jquery-once-body').on('mousedown keyup touchstart', 'a', function(e) {
        var $link = $(e.target).closest('a'),
            href  = $link.attr('href');

        if (href.match(/^(http|https):/i) && href.indexOf(location.host)) {
          if (href.indexOf('addthis.com') == -1 && href.indexOf('youtube.com') == -1 && href.indexOf('twitter.com') == -1 && href.indexOf('facebook.com') == -1 && href.indexOf('instagram.com') == -1 && href.indexOf('pinterest.com') == -1) {
            ga('send', 'event', 'Partner Referral', 'Outgoing', href);
          }
        }
      });

      // Hyperlink has been clicked in footer circulation module clicks
      $('.circulation a', context).bind('click', function(e) {
        ga('send', 'event', 'Bottom Circulation Module', 'Clicked');
      });

      // Content has been expanded (Dual State Module)
      $('.btn-expand', context).bind('click', function(e) {
        ga('send', 'event', 'Dual State Module', 'Expand');
      });

      // Content Share
      $('.field-name-field-share-buttons', context).on('click', 'a', function(e) {
        var network = $(e.currentTarget).attr('title');
        ga('send', 'event', 'Content Share', network);
      });

      // Language Selection
      $('.language-switcher-locale-url', context).on('click', 'a', function(e) {
        var language = $(e.target).attr('xml:lang');
        ga('send', 'event', 'Select Language', language);
      });

      // Social Channel Selection
      $('#stay-tuned', context).on('click', 'a', function(e) {
        var network = $(e.target).closest('li').attr('class');
        ga('send', 'event', 'Social Referral', network);
      });

      // Deal Redeem
      $('.field-sub-items--deal', context).on('click', 'a', function(e) {
        var identifier = $(e.target).closest('.field-sub-items--deal').data('id');
        ga('send', 'event', 'Deal Redeem', identifier);
      });

      // Error pages
      if (Drupal.settings.error) {
        ga('send', 'event', 'Error', Drupal.settings.error, window.location.href);
      }

      // // Site Search
      // if (Drupal.settings.tealium.search_keyword) {
      //   ga('send', 'pageview', '/search/node?q=' + Drupal.settings.tealium.search_keyword);
      // }
    }
  };

  /**
   * Content Consumption events.
   */
  Drupal.behaviors.eventTrackingContentConsumption = {
    attach: function(context, settings) {
      $('body').once('jquery-once-event-tracking-content-consumption', function() {
        if (typeof ga == 'undefined') {
          return;
        }

        // Time Threshold
        // Create timer and fire event with incremented counter value every 15 seconds.
        // See Example 2 in accompanying HTML for example code.
        var gaTosTracking = 0;
        var interval = window.setInterval(function() {
          gaTosTracking += 15;
          var pageTimer = gaTosTracking.toString();
          ga('send', 'event', 'Page Timer', 'Time', pageTimer, undefined, {'nonInteraction': 1});

          if (gaTosTracking * 1000 >= 1800000) {
            window.clearInterval(interval);
          }
        }, 15000);

        // Helper function to determine content consumption, borrowed from:
        // http://stackoverflow.com/questions/1225102/jquery-event-to-trigger-action-when-a-div-is-made-visible
        var _oldShow = $.fn.show;

        $.fn.show = function(speed, oldCallback) {
          return $(this).each(function() {
            var obj         = $(this),
              newCallback = function() {
                if ($.isFunction(oldCallback)) {
                  oldCallback.apply(obj);
                }
                obj.trigger('afterShow');
              };

            // you can trigger a before show if you want
            obj.trigger('beforeShow');

            // now use the old function to show the element passing the new callback
            _oldShow.apply(obj, [speed, newCallback]);
          });
        };

        // Announce content has been consumed (we have reached circulation footer).
        $('#block-vca-site-circulation-footer', context).bind('beforeShow', function() {
          if (!$('#block-vca-site-circulation-footer').hasClass('has-more-content') && !$('#footer').hasClass('has-more-content')) {
            gaContentConsume('complete');
          }
        });

        // Content Consumption Begin
        // Call function with 'begin' argument once the user has scrolled beyond the header image.
        // See Example 1 in accompanying HTML for example code.
        var $heroImage = $('.welcome .field-name-field-hero-image:eq(0)');

        $(window).scroll(function(e) {
          var $target  = $(e.target),
              wayPoint = 0;

          // Start tracking after scoll pass hero image
          if ($heroImage.length) {
            wayPoint = $heroImage.offset().top + $heroImage.innerHeight();
          }

          if ($target.scrollTop() > wayPoint) {
            gaContentConsume('begin');
            $(window).off('scroll', arguments.callee);
          }
        });

        // Content Consumption Complete
        $(window).on('scroll', function(e) {
          var $target  = $(e.target),
              wayPoint = $(document).height - $(window).height();

          if ($('#block-vca-site-circulation-footer').length) {
            wayPoint = $('#block-vca-site-circulation-footer').offset().top - $(window).height();
          }
          else if ($('#footer').length) {
            wayPoint = $('#footer').offset().top - $(window).height();
          }

          if ($target.scrollTop() > wayPoint) {
            if (!$('#block-vca-site-circulation-footer').hasClass('has-more-content') && !$('#footer').hasClass('has-more-content')) {
              gaContentConsume('complete');
              $(window).off('scroll', arguments.callee);
            }
          }
        });
      });
    }
  };

  /**
   * Form Tracking.
   */
  Drupal.behaviors.eventTrackingForm = {
    attach: function (context, settings) {
      if (typeof ga == 'undefined') {
        return;
      }

      $('.webform-client-form[action="/visitors-guide-bulk-order-form"]', context).on('focus', 'input', function(e) {
        var fieldName = $(e.target).attr('id');
        if (fieldName) {
          fieldName = fieldName.replace('edit-submitted-', '');
          ga('send', 'event', 'CVG Bulk Order Form', fieldName, 'Focus');
        }
      });

      $('.webform-client-form[action="/visitors-guide-bulk-order-form"]', context).on('blur', 'input', function(e) {
        var fieldName = $(e.target).attr('id');
        if (fieldName) {
          fieldName = fieldName.replace('edit-submitted-', '');
          ga('send', 'event', 'CVG Bulk Order Form', fieldName, 'Blur');
        }
      });

      $('.webform-client-form[action="/visitors-guide-bulk-order-form"]', context).on("submit", function(){
        ga('send', 'event', 'CVG Bulk Order Form', 'Signup');
      });
      $('.webform-client-form[action="/visitors-guide-request"]', context).on('focus', 'input', function(e) {
        var fieldName = $(e.target).attr('id');
        if (fieldName) {
          fieldName = fieldName.replace('edit-submitted-', '');
          ga('send', 'event', 'Visitors Guide', fieldName, 'Focus');
        }
      });

      $('.webform-client-form[action="/visitors-guide-request"]', context).on('blur', 'input', function(e) {
        var fieldName = $(e.target).attr('id');
        if (fieldName) {
          fieldName = fieldName.replace('edit-submitted-', '');
          ga('send', 'event', 'Visitors Guide', fieldName, 'Blur');
        }
      });

      $('.webform-client-form[action="/visitors-guide-request"]', context).on("submit", function(){
        ga('send', 'event', 'Visitors Guide', 'Signup');
      });

      $('#edit-submitted-subscription-1', context).on('change', function(e) {
        if (e.target.checked) {
          ga('send', 'event', 'Visitors Guide', 'Newsletter', 'Check');
        }
        else {
          ga('send', 'event', 'Visitors Guide', 'Newsletter', 'Uncheck');
        }
      });

      $('.visitors-guide-button').click(function() {
        ga('send', 'event', 'Visitors Guide', 'Digital Visitors Guide Click');
      });

      $('.road-trip-button').click(function() {
        ga('send', 'event', 'Visitors Guide', 'Digital Road Trips Click');
      });

      $('.newsletter-request-form', context).on('focus', 'input', function(e) {
        var fieldName = $(e.target).attr('id');
        if (fieldName) {
          fieldName = fieldName.replace('edit-submitted-', '');
          ga('send', 'event', 'Newsletter Signup Form', fieldName, 'Focus');
        }
      });

      $('.newsletter-request-form', context).on('blur', 'input', function(e) {
        var fieldName = $(e.target).attr('id');
        if (fieldName) {
          fieldName = fieldName.replace('edit-submitted-', '');
          ga('send', 'event', 'Newsletter Signup Form', fieldName, 'Blur');
        }
      });

      $('.newsletter-request-form', context).on('submit', function() {
        ga('send', 'event', 'Newsletter Signup Form', 'Signup');
      });
    }
  };

  Drupal.behaviors.eventTrackingMap = {
    attach: function (context, settings) {
      /* Init code*/
      if (typeof ga == 'undefined') {
        return;
      }

      // View Map
      $('.container-map li button', context).bind('click', function(e) {
        var location = $(this).text();
        ga('send', 'event', 'View Map', location);
      })

      // View Map
      $('.container-map-share', context).on('click', '.icon-location', function(e) {
        var $target = $(e.target);

        if ($target.hasClass('active')) {
          var identifier = $target.closest('article').data('node');
          ga('send', 'event', 'View Map', identifier);
        }
      });
    }
  };

  Drupal.behaviors.eventTrackingENews = {
    attach: function (context, settings) {
      $('#e-news').click(function() {
        var current_url = window.location.pathname;
        ga('send', 'event', 'ENews', 'click', current_url);
      });
    }
  };

  /**
   * Retrieve the current module.
   */
  function getCurrentModule($modules) {
    var $current       = null,
        lastViewHeight = 0,
        pageTop        = gaPageScrollGetPosition(),
        pageBottom     = pageTop + $(window).height();

    $modules.each(function() {
      var $module      = $(this),
          moduleTop    = $module.offset().top,
          moduleHeight = $module.innerHeight(),
          moduleBottom = moduleTop + moduleHeight;

      var viewHeight = moduleHeight + Math.min(moduleTop - pageTop, 0) + Math.min(pageBottom - moduleBottom, 0);

      if (viewHeight > 0) {
        if (viewHeight > lastViewHeight) {
          lastViewHeight = viewHeight;
          $current  = $module;
        }
        else {
          return false;
        }
      }
    });

    return $current;
  }


  /**
   * Consume function.
   */
  var gaContentConsumeStart;
  var gaContentConsumeStop;
  var gaContentConsumeTime;
  var gaContentConsumeActive = 0;
  var gaContentConsumeSent = 0;

  function gaContentConsume(type) {
    if (!gaContentConsumeSent) {
      if (type == 'begin' && !gaContentConsumeActive) {
        gaContentConsumeActive  = 1;    // Debounce
        gaContentConsumeStart   = new Date().getTime() / 1000;
        ga('send', 'event', 'Content Consumption', 'Begin', {'nonInteraction': 1});
      } else if (type == 'complete' && gaContentConsumeActive) {
        gaContentConsumeActive  = 0;
        gaContentConsumeStop    = new Date().getTime() / 1000;
        gaContentConsumeTime    = Math.floor(gaContentConsumeStop - gaContentConsumeStart);
        ga('send', 'event', 'Content Consumption', 'Complete', gaContentConsumeTime);
        gaContentConsumeSent    = 1;    // Only send once
      } else {
        // Do nothing
      }
    }
  }

  /**
   * Scroll helper.
   */
  var gaPageScrollStartingPos  = gaPageScrollGetPosition();
  var gaPageScrollWindowHeight = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
  var gaPageScrollTarget       = gaPageScrollStartingPos + gaPageScrollWindowHeight;
  var gaPageScrollNum          = 1;

  function gaPageScrollGetPosition() {
    return (window.pageYOffset !== undefined) ? window.pageYOffset : (document.documentElement || document.body.parentNode || document.body).scrollTop;
  }
})(jQuery);
;
/**
 * @file
 * Some basic behaviors and utility functions for Views.
 */
(function ($) {

  Drupal.Views = {};

  /**
   * JQuery UI tabs, Views integration component.
   */
  Drupal.behaviors.viewsTabs = {
    attach: function (context) {
      if ($.viewsUi && $.viewsUi.tabs) {
        $('#views-tabset').once('views-processed').viewsTabs({
          selectedClass: 'active'
        });
      }

      $('a.views-remove-link').once('views-processed').click(function(event) {
        var id = $(this).attr('id').replace('views-remove-link-', '');
        $('#views-row-' + id).hide();
        $('#views-removed-' + id).attr('checked', true);
        event.preventDefault();
      });
      /**
    * Here is to handle display deletion
    * (checking in the hidden checkbox and hiding out the row).
    */
      $('a.display-remove-link')
        .addClass('display-processed')
        .click(function() {
          var id = $(this).attr('id').replace('display-remove-link-', '');
          $('#display-row-' + id).hide();
          $('#display-removed-' + id).attr('checked', true);
          return false;
        });
    }
  };

  /**
 * Helper function to parse a querystring.
 */
  Drupal.Views.parseQueryString = function (query) {
    var args = {};
    var pos = query.indexOf('?');
    if (pos != -1) {
      query = query.substring(pos + 1);
    }
    var pairs = query.split('&');
    for (var i in pairs) {
      if (typeof(pairs[i]) == 'string') {
        var pair = pairs[i].split('=');
        // Ignore the 'q' path argument, if present.
        if (pair[0] != 'q' && pair[1]) {
          args[decodeURIComponent(pair[0].replace(/\+/g, ' '))] = decodeURIComponent(pair[1].replace(/\+/g, ' '));
        }
      }
    }
    return args;
  };

  /**
 * Helper function to return a view's arguments based on a path.
 */
  Drupal.Views.parseViewArgs = function (href, viewPath) {

    // Provide language prefix.
    if (Drupal.settings.pathPrefix) {
      var viewPath = Drupal.settings.pathPrefix + viewPath;
    }
    var returnObj = {};
    var path = Drupal.Views.getPath(href);
    // Ensure we have a correct path.
    if (viewPath && path.substring(0, viewPath.length + 1) == viewPath + '/') {
      var args = decodeURIComponent(path.substring(viewPath.length + 1, path.length));
      returnObj.view_args = args;
      returnObj.view_path = path;
    }
    return returnObj;
  };

  /**
 * Strip off the protocol plus domain from an href.
 */
  Drupal.Views.pathPortion = function (href) {
    // Remove e.g. http://example.com if present.
    var protocol = window.location.protocol;
    if (href.substring(0, protocol.length) == protocol) {
      // 2 is the length of the '//' that normally follows the protocol.
      href = href.substring(href.indexOf('/', protocol.length + 2));
    }
    return href;
  };

  /**
 * Return the Drupal path portion of an href.
 */
  Drupal.Views.getPath = function (href) {
    href = Drupal.Views.pathPortion(href);
    href = href.substring(Drupal.settings.basePath.length, href.length);
    // 3 is the length of the '?q=' added to the url without clean urls.
    if (href.substring(0, 3) == '?q=') {
      href = href.substring(3, href.length);
    }
    var chars = ['#', '?', '&'];
    for (var i in chars) {
      if (href.indexOf(chars[i]) > -1) {
        href = href.substr(0, href.indexOf(chars[i]));
      }
    }
    return href;
  };

})(jQuery);
;
(function ($) {

/**
 * A progressbar object. Initialized with the given id. Must be inserted into
 * the DOM afterwards through progressBar.element.
 *
 * method is the function which will perform the HTTP request to get the
 * progress bar state. Either "GET" or "POST".
 *
 * e.g. pb = new progressBar('myProgressBar');
 *      some_element.appendChild(pb.element);
 */
Drupal.progressBar = function (id, updateCallback, method, errorCallback) {
  var pb = this;
  this.id = id;
  this.method = method || 'GET';
  this.updateCallback = updateCallback;
  this.errorCallback = errorCallback;

  // The WAI-ARIA setting aria-live="polite" will announce changes after users
  // have completed their current activity and not interrupt the screen reader.
  this.element = $('<div class="progress" aria-live="polite"></div>').attr('id', id);
  this.element.html('<div class="bar"><div class="filled"></div></div>' +
                    '<div class="percentage"></div>' +
                    '<div class="message">&nbsp;</div>');
};

/**
 * Set the percentage and status message for the progressbar.
 */
Drupal.progressBar.prototype.setProgress = function (percentage, message) {
  if (percentage >= 0 && percentage <= 100) {
    $('div.filled', this.element).css('width', percentage + '%');
    $('div.percentage', this.element).html(percentage + '%');
  }
  $('div.message', this.element).html(message);
  if (this.updateCallback) {
    this.updateCallback(percentage, message, this);
  }
};

/**
 * Start monitoring progress via Ajax.
 */
Drupal.progressBar.prototype.startMonitoring = function (uri, delay) {
  this.delay = delay;
  this.uri = uri;
  this.sendPing();
};

/**
 * Stop monitoring progress via Ajax.
 */
Drupal.progressBar.prototype.stopMonitoring = function () {
  clearTimeout(this.timer);
  // This allows monitoring to be stopped from within the callback.
  this.uri = null;
};

/**
 * Request progress data from server.
 */
Drupal.progressBar.prototype.sendPing = function () {
  if (this.timer) {
    clearTimeout(this.timer);
  }
  if (this.uri) {
    var pb = this;
    // When doing a post request, you need non-null data. Otherwise a
    // HTTP 411 or HTTP 406 (with Apache mod_security) error may result.
    $.ajax({
      type: this.method,
      url: this.uri,
      data: '',
      dataType: 'json',
      success: function (progress) {
        // Display errors.
        if (progress.status == 0) {
          pb.displayError(progress.data);
          return;
        }
        // Update display.
        pb.setProgress(progress.percentage, progress.message);
        // Schedule next timer.
        pb.timer = setTimeout(function () { pb.sendPing(); }, pb.delay);
      },
      error: function (xmlhttp) {
        pb.displayError(Drupal.ajaxError(xmlhttp, pb.uri));
      }
    });
  }
};

/**
 * Display errors on the page.
 */
Drupal.progressBar.prototype.displayError = function (string) {
  var error = $('<div class="messages error"></div>').html(string);
  $(this.element).before(error).hide();

  if (this.errorCallback) {
    this.errorCallback(this);
  }
};

})(jQuery);
;
/**
 * @file
 * Handles AJAX fetching of views, including filter submission and response.
 */
(function ($) {

  /**
   * Attaches the AJAX behavior to exposed filter forms and key views links.
   */
  Drupal.behaviors.ViewsAjaxView = {};
  Drupal.behaviors.ViewsAjaxView.attach = function() {
    if (Drupal.settings && Drupal.settings.views && Drupal.settings.views.ajaxViews) {
      $.each(Drupal.settings.views.ajaxViews, function(i, settings) {
        Drupal.views.instances[i] = new Drupal.views.ajaxView(settings);
      });
    }
  };

  Drupal.views = {};
  Drupal.views.instances = {};

  /**
   * JavaScript object for a certain view.
   */
  Drupal.views.ajaxView = function(settings) {
    var selector = '.view-dom-id-' + settings.view_dom_id;
    this.$view = $(selector);

    // Retrieve the path to use for views' ajax.
    var ajax_path = Drupal.settings.views.ajax_path;

    // If there are multiple views this might've ended up showing up multiple
    // times.
    if (ajax_path.constructor.toString().indexOf("Array") != -1) {
      ajax_path = ajax_path[0];
    }

    // Check if there are any GET parameters to send to views.
    var queryString = window.location.search || '';
    if (queryString !== '') {
      // Remove the question mark and Drupal path component if any.
      var queryString = queryString.slice(1).replace(/q=[^&]+&?|&?render=[^&]+/, '');
      if (queryString !== '') {
        // If there is a '?' in ajax_path, clean url are on and & should be
        // used to add parameters.
        queryString = ((/\?/.test(ajax_path)) ? '&' : '?') + queryString;
      }
    }

    this.element_settings = {
      url: ajax_path + queryString,
      submit: settings,
      setClick: true,
      event: 'click',
      selector: selector,
      progress: {
        type: 'throbber'
      }
    };

    this.settings = settings;

    // Add the ajax to exposed forms.
    this.$exposed_form = $('#views-exposed-form-' + settings.view_name.replace(/_/g, '-') + '-' + settings.view_display_id.replace(/_/g, '-'));
    this.$exposed_form.once(jQuery.proxy(this.attachExposedFormAjax, this));

    // Store Drupal.ajax objects here for all pager links.
    this.links = [];

    // Add the ajax to pagers.
    this.$view
      .once(jQuery.proxy(this.attachPagerAjax, this));

    // Add a trigger to update this view specifically. In order to trigger a
    // refresh use the following code.
    //
    // @code
    // jQuery('.view-name').trigger('RefreshView');
    // @endcode
    // Add a trigger to update this view specifically.
    var self_settings = this.element_settings;
    self_settings.event = 'RefreshView';
    this.refreshViewAjax = new Drupal.ajax(this.selector, this.$view, self_settings);
  };

  Drupal.views.ajaxView.prototype.attachExposedFormAjax = function() {
    var button = $('input[type=submit], button[type=submit], input[type=image]', this.$exposed_form);
    button = button[0];

    // Call the autocomplete submit before doing AJAX.
    $(button).click(function () {
      if (Drupal.autocompleteSubmit) {
        Drupal.autocompleteSubmit();
      }
    });

    this.exposedFormAjax = new Drupal.ajax($(button).attr('id'), button, this.element_settings);
  };

  /**
   * Attach the ajax behavior to each link.
   */
  Drupal.views.ajaxView.prototype.attachPagerAjax = function() {
    this.$view.find('ul.pager > li > a, th.views-field a, .attachment .views-summary a')
      .each(jQuery.proxy(this.attachPagerLinkAjax, this));
  };

  /**
   * Attach the ajax behavior to a singe link.
   */
  Drupal.views.ajaxView.prototype.attachPagerLinkAjax = function(id, link) {
    var $link = $(link);
    // Don't attach to pagers inside nested views.
    if ($link.closest('.view')[0] !== this.$view[0]) {
      return;
    }
    var viewData = {};
    var href = $link.attr('href');

    // Provide a default page if none has been set. This must be done
    // prior to merging with settings to avoid accidentally using the
    // page landed on instead of page 1.
    if (typeof(viewData.page) === 'undefined') {
      viewData.page = 0;
    }

    // Construct an object using the settings defaults and then overriding
    // with data specific to the link.
    $.extend(
    viewData,
    this.settings,
    Drupal.Views.parseQueryString(href),
    // Extract argument data from the URL.
    Drupal.Views.parseViewArgs(href, this.settings.view_base_path)
    );

    // For anchor tags, these will go to the target of the anchor rather
    // than the usual location.
    $.extend(viewData, Drupal.Views.parseViewArgs(href, this.settings.view_base_path));

    this.element_settings.submit = viewData;
    this.pagerAjax = new Drupal.ajax(false, $link, this.element_settings);
    this.links.push(this.pagerAjax);
  };

  Drupal.ajax.prototype.commands.viewsScrollTop = function (ajax, response, status) {
    // Scroll to the top of the view. This will allow users
    // to browse newly loaded content after e.g. clicking a pager
    // link.
    var offset = $(response.selector).offset();
    // We can't guarantee that the scrollable object should be
    // the body, as the view could be embedded in something
    // more complex such as a modal popup. Recurse up the DOM
    // and scroll the first element that has a non-zero top.
    var scrollTarget = response.selector;
    while ($(scrollTarget).scrollTop() == 0 && $(scrollTarget).parent()) {
      scrollTarget = $(scrollTarget).parent();
    }
    // Only scroll upward.
    if (offset.top - 10 < $(scrollTarget).scrollTop()) {
      $(scrollTarget).animate({scrollTop: (offset.top - 10)}, 500);
    }
  };

})(jQuery);
;
/*! Lazy Load 1.9.3 - MIT license - Copyright 2010-2013 Mika Tuupola */
!function(a,b,c,d){var e=a(b);a.fn.lazyload=function(f){function g(){var b=0;i.each(function(){var c=a(this);if(!j.skip_invisible||c.is(":visible"))if(a.abovethetop(this,j)||a.leftofbegin(this,j));else if(a.belowthefold(this,j)||a.rightoffold(this,j)){if(++b>j.failure_limit)return!1}else c.trigger("appear"),b=0})}var h,i=this,j={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:b,data_attribute:"original",skip_invisible:!0,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};return f&&(d!==f.failurelimit&&(f.failure_limit=f.failurelimit,delete f.failurelimit),d!==f.effectspeed&&(f.effect_speed=f.effectspeed,delete f.effectspeed),a.extend(j,f)),h=j.container===d||j.container===b?e:a(j.container),0===j.event.indexOf("scroll")&&h.bind(j.event,function(){return g()}),this.each(function(){var b=this,c=a(b);b.loaded=!1,(c.attr("src")===d||c.attr("src")===!1)&&c.is("img")&&c.attr("src",j.placeholder),c.one("appear",function(){if(!this.loaded){if(j.appear){var d=i.length;j.appear.call(b,d,j)}a("<img />").bind("load",function(){var d=c.attr("data-"+j.data_attribute);c.hide(),c.is("img")?c.attr("src",d):c.css("background-image","url('"+d+"')"),c[j.effect](j.effect_speed),b.loaded=!0;var e=a.grep(i,function(a){return!a.loaded});if(i=a(e),j.load){var f=i.length;j.load.call(b,f,j)}}).attr("src",c.attr("data-"+j.data_attribute))}}),0!==j.event.indexOf("scroll")&&c.bind(j.event,function(){b.loaded||c.trigger("appear")})}),e.bind("resize",function(){g()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&e.bind("pageshow",function(b){b.originalEvent&&b.originalEvent.persisted&&i.each(function(){a(this).trigger("appear")})}),a(c).ready(function(){g()}),this},a.belowthefold=function(c,f){var g;return g=f.container===d||f.container===b?(b.innerHeight?b.innerHeight:e.height())+e.scrollTop():a(f.container).offset().top+a(f.container).height(),g<=a(c).offset().top-f.threshold},a.rightoffold=function(c,f){var g;return g=f.container===d||f.container===b?e.width()+e.scrollLeft():a(f.container).offset().left+a(f.container).width(),g<=a(c).offset().left-f.threshold},a.abovethetop=function(c,f){var g;return g=f.container===d||f.container===b?e.scrollTop():a(f.container).offset().top,g>=a(c).offset().top+f.threshold+a(c).height()},a.leftofbegin=function(c,f){var g;return g=f.container===d||f.container===b?e.scrollLeft():a(f.container).offset().left,g>=a(c).offset().left+f.threshold+a(c).width()},a.inviewport=function(b,c){return!(a.rightoffold(b,c)||a.leftofbegin(b,c)||a.belowthefold(b,c)||a.abovethetop(b,c))},a.extend(a.expr[":"],{"below-the-fold":function(b){return a.belowthefold(b,{threshold:0})},"above-the-top":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-screen":function(b){return a.rightoffold(b,{threshold:0})},"left-of-screen":function(b){return!a.rightoffold(b,{threshold:0})},"in-viewport":function(b){return a.inviewport(b,{threshold:0})},"above-the-fold":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-fold":function(b){return a.rightoffold(b,{threshold:0})},"left-of-fold":function(b){return!a.rightoffold(b,{threshold:0})}})}(jQuery,window,document);;
/*!
 * jQuery Transit - CSS3 transitions and transformations
 * (c) 2011-2012 Rico Sta. Cruz <rico@ricostacruz.com>
 * MIT Licensed.
 *
 * http://ricostacruz.com/jquery.transit
 * http://github.com/rstacruz/jquery.transit
 */
(function(k){k.transit={version:"0.9.9",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:true,useTransitionEnd:false};var d=document.createElement("div");var q={};function b(v){if(v in d.style){return v}var u=["Moz","Webkit","O","ms"];var r=v.charAt(0).toUpperCase()+v.substr(1);if(v in d.style){return v}for(var t=0;t<u.length;++t){var s=u[t]+r;if(s in d.style){return s}}}function e(){d.style[q.transform]="";d.style[q.transform]="rotateY(90deg)";return d.style[q.transform]!==""}var a=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;q.transition=b("transition");q.transitionDelay=b("transitionDelay");q.transform=b("transform");q.transformOrigin=b("transformOrigin");q.transform3d=e();var i={transition:"transitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"};var f=q.transitionEnd=i[q.transition]||null;for(var p in q){if(q.hasOwnProperty(p)&&typeof k.support[p]==="undefined"){k.support[p]=q[p]}}d=null;k.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"};k.cssHooks["transit:transform"]={get:function(r){return k(r).data("transform")||new j()},set:function(s,r){var t=r;if(!(t instanceof j)){t=new j(t)}if(q.transform==="WebkitTransform"&&!a){s.style[q.transform]=t.toString(true)}else{s.style[q.transform]=t.toString()}k(s).data("transform",t)}};k.cssHooks.transform={set:k.cssHooks["transit:transform"].set};if(k.fn.jquery<"1.8"){k.cssHooks.transformOrigin={get:function(r){return r.style[q.transformOrigin]},set:function(r,s){r.style[q.transformOrigin]=s}};k.cssHooks.transition={get:function(r){return r.style[q.transition]},set:function(r,s){r.style[q.transition]=s}}}n("scale");n("translate");n("rotate");n("rotateX");n("rotateY");n("rotate3d");n("perspective");n("skewX");n("skewY");n("x",true);n("y",true);function j(r){if(typeof r==="string"){this.parse(r)}return this}j.prototype={setFromString:function(t,s){var r=(typeof s==="string")?s.split(","):(s.constructor===Array)?s:[s];r.unshift(t);j.prototype.set.apply(this,r)},set:function(s){var r=Array.prototype.slice.apply(arguments,[1]);if(this.setter[s]){this.setter[s].apply(this,r)}else{this[s]=r.join(",")}},get:function(r){if(this.getter[r]){return this.getter[r].apply(this)}else{return this[r]||0}},setter:{rotate:function(r){this.rotate=o(r,"deg")},rotateX:function(r){this.rotateX=o(r,"deg")},rotateY:function(r){this.rotateY=o(r,"deg")},scale:function(r,s){if(s===undefined){s=r}this.scale=r+","+s},skewX:function(r){this.skewX=o(r,"deg")},skewY:function(r){this.skewY=o(r,"deg")},perspective:function(r){this.perspective=o(r,"px")},x:function(r){this.set("translate",r,null)},y:function(r){this.set("translate",null,r)},translate:function(r,s){if(this._translateX===undefined){this._translateX=0}if(this._translateY===undefined){this._translateY=0}if(r!==null&&r!==undefined){this._translateX=o(r,"px")}if(s!==null&&s!==undefined){this._translateY=o(s,"px")}this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var r=(this.scale||"1,1").split(",");if(r[0]){r[0]=parseFloat(r[0])}if(r[1]){r[1]=parseFloat(r[1])}return(r[0]===r[1])?r[0]:r},rotate3d:function(){var t=(this.rotate3d||"0,0,0,0deg").split(",");for(var r=0;r<=3;++r){if(t[r]){t[r]=parseFloat(t[r])}}if(t[3]){t[3]=o(t[3],"deg")}return t}},parse:function(s){var r=this;s.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(t,v,u){r.setFromString(v,u)})},toString:function(t){var s=[];for(var r in this){if(this.hasOwnProperty(r)){if((!q.transform3d)&&((r==="rotateX")||(r==="rotateY")||(r==="perspective")||(r==="transformOrigin"))){continue}if(r[0]!=="_"){if(t&&(r==="scale")){s.push(r+"3d("+this[r]+",1)")}else{if(t&&(r==="translate")){s.push(r+"3d("+this[r]+",0)")}else{s.push(r+"("+this[r]+")")}}}}}return s.join(" ")}};function m(s,r,t){if(r===true){s.queue(t)}else{if(r){s.queue(r,t)}else{t()}}}function h(s){var r=[];k.each(s,function(t){t=k.camelCase(t);t=k.transit.propertyMap[t]||k.cssProps[t]||t;t=c(t);if(k.inArray(t,r)===-1){r.push(t)}});return r}function g(s,v,x,r){var t=h(s);if(k.cssEase[x]){x=k.cssEase[x]}var w=""+l(v)+" "+x;if(parseInt(r,10)>0){w+=" "+l(r)}var u=[];k.each(t,function(z,y){u.push(y+" "+w)});return u.join(", ")}k.fn.transition=k.fn.transit=function(z,s,y,C){var D=this;var u=0;var w=true;if(typeof s==="function"){C=s;s=undefined}if(typeof y==="function"){C=y;y=undefined}if(typeof z.easing!=="undefined"){y=z.easing;delete z.easing}if(typeof z.duration!=="undefined"){s=z.duration;delete z.duration}if(typeof z.complete!=="undefined"){C=z.complete;delete z.complete}if(typeof z.queue!=="undefined"){w=z.queue;delete z.queue}if(typeof z.delay!=="undefined"){u=z.delay;delete z.delay}if(typeof s==="undefined"){s=k.fx.speeds._default}if(typeof y==="undefined"){y=k.cssEase._default}s=l(s);var E=g(z,s,y,u);var B=k.transit.enabled&&q.transition;var t=B?(parseInt(s,10)+parseInt(u,10)):0;if(t===0){var A=function(F){D.css(z);if(C){C.apply(D)}if(F){F()}};m(D,w,A);return D}var x={};var r=function(H){var G=false;var F=function(){if(G){D.unbind(f,F)}if(t>0){D.each(function(){this.style[q.transition]=(x[this]||null)})}if(typeof C==="function"){C.apply(D)}if(typeof H==="function"){H()}};if((t>0)&&(f)&&(k.transit.useTransitionEnd)){G=true;D.bind(f,F)}else{window.setTimeout(F,t)}D.each(function(){if(t>0){this.style[q.transition]=E}k(this).css(z)})};var v=function(F){this.offsetWidth;r(F)};m(D,w,v);return this};function n(s,r){if(!r){k.cssNumber[s]=true}k.transit.propertyMap[s]=q.transform;k.cssHooks[s]={get:function(v){var u=k(v).css("transit:transform");return u.get(s)},set:function(v,w){var u=k(v).css("transit:transform");u.setFromString(s,w);k(v).css({"transit:transform":u})}}}function c(r){return r.replace(/([A-Z])/g,function(s){return"-"+s.toLowerCase()})}function o(s,r){if((typeof s==="string")&&(!s.match(/^[\-0-9\.]+$/))){return s}else{return""+s+r}}function l(s){var r=s;if(k.fx.speeds[r]){r=k.fx.speeds[r]}return o(r,"ms")}k.transit.getTransitionValue=g})(jQuery);;
/**
 * @file
 * A JavaScript file for the theme.
 * This file should be used as a template for your other js files.
 * It defines a drupal behavior the "Drupal way".
 *
 */

// JavaScript should be made compatible with libraries other than jQuery by
// wrapping it with an "anonymous closure". See:
// - https://drupal.org/node/1446420
// - http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth

(function ($, Drupal, window, document, undefined) {
  'use strict';

  // To understand behaviors, see https://drupal.org/node/756722#behaviors
  Drupal.behaviors.hideSubmitBlockit = {
    attach: function(context) {
      var timeoutId = null;
      $('form', context).once('hideSubmitButton', function () {
        var $form = $(this);

        // Bind to input elements.
        if (Drupal.settings.hide_submit.hide_submit_method === 'indicator') {
          // Replace input elements with buttons.
          $('input.form-submit', $form).each(function(index, el) {
            var attrs = {};

            $.each($(this)[0].attributes, function(idx, attr) {
                attrs[attr.nodeName] = attr.nodeValue;
            });

            $(this).replaceWith(function() {
                return $("<button/>", attrs).append($(this).attr('value'));
            });
          });
          // Add needed attributes to the submit buttons.
          $('button.form-submit', $form).each(function(index, el) {
            $(this).addClass('ladda-button button').attr({
              'data-style': Drupal.settings.hide_submit.hide_submit_indicator_style,
              'data-spinner-color': Drupal.settings.hide_submit.hide_submit_spinner_color,
              'data-spinner-lines': Drupal.settings.hide_submit.hide_submit_spinner_lines
            });
          });
          Ladda.bind('.ladda-button', $form, {
            timeout: Drupal.settings.hide_submit.hide_submit_reset_time
          });
        }
        else {
          $('input.form-submit, button.form-submit', $form).click(function (e) {
            var el = $(this);
            el.after('<input type="hidden" name="' + el.attr('name') + '" value="' + el.attr('value') + '" />');
            return true;
          });
        }

        // Bind to form submit.
        $('form', context).submit(function (e) {
          var $inp;
          if (!e.isPropagationStopped()) {
            if (Drupal.settings.hide_submit.hide_submit_method === 'disable') {
              $('input.form-submit, button.form-submit', $form).attr('disabled', 'disabled').each(function (i) {
                var $button = $(this);
                if (Drupal.settings.hide_submit.hide_submit_css) {
                  $button.addClass(Drupal.settings.hide_submit.hide_submit_css);
                }
                if (Drupal.settings.hide_submit.hide_submit_abtext) {
                  $button.val($button.val() + ' ' + Drupal.settings.hide_submit.hide_submit_abtext);
                }
                $inp = $button;
              });

              if ($inp && Drupal.settings.hide_submit.hide_submit_atext) {
                $inp.after('<span class="hide-submit-text">' + Drupal.checkPlain(Drupal.settings.hide_submit.hide_submit_atext) + '</span>');
              }
            }
            else if (Drupal.settings.hide_submit.hide_submit_method !== 'indicator'){
              var pdiv = '<div class="hide-submit-text' + (Drupal.settings.hide_submit.hide_submit_hide_css ? ' ' + Drupal.checkPlain(Drupal.settings.hide_submit.hide_submit_hide_css) + '"' : '') + '>' + Drupal.checkPlain(Drupal.settings.hide_submit.hide_submit_hide_text) + '</div>';
              if (Drupal.settings.hide_submit.hide_submit_hide_fx) {
                $('input.form-submit, button.form-submit', $form).addClass(Drupal.settings.hide_submit.hide_submit_css).fadeOut(100).eq(0).after(pdiv);
                $('input.form-submit, button.form-submit', $form).next().fadeIn(100);
              }
              else {
                $('input.form-submit, button.form-submit', $form).addClass(Drupal.settings.hide_submit.hide_submit_css).hide().eq(0).after(pdiv);
              }
            }
            // Add a timeout to reset the buttons (if needed).
            if (Drupal.settings.hide_submit.hide_submit_reset_time) {
              timeoutId = window.setTimeout(function() {
                hideSubmitResetButtons(null, $form);
              }, Drupal.settings.hide_submit.hide_submit_reset_time);
            }
          }
          return true;
        });
      });

      // Bind to clientsideValidationFormHasErrors to support clientside validation.
      // $(document).bind('clientsideValidationFormHasErrors', function(event, form) {
        //hideSubmitResetButtons(event, form.form);
      // });

      // Reset all buttons.
      function hideSubmitResetButtons(event, form) {
        // Clear timer.
        window.clearTimeout(timeoutId);
        timeoutId = null;
        switch (Drupal.settings.hide_submit.hide_submit_method) {
          case 'disable':
            $('input.' + Drupal.checkPlain(Drupal.settings.hide_submit.hide_submit_css) + ', button.' + Drupal.checkPlain(Drupal.settings.hide_submit.hide_submit_css), form)
              .each(function (i, el) {
                $(el).removeClass(Drupal.checkPlain(Drupal.settings.hide_submit.hide_submit_hide_css))
                  .removeAttr('disabled');
              });
            $('.hide-submit-text', form).remove();
            break;

          case 'indicator':
            Ladda.stopAll();
            break;

          default:
            $('input.' + Drupal.checkPlain(Drupal.settings.hide_submit.hide_submit_css) + ', button.' + Drupal.checkPlain(Drupal.settings.hide_submit.hide_submit_css), form)
              .each(function (i, el) {
                $(el).stop()
                  .removeClass(Drupal.checkPlain(Drupal.settings.hide_submit.hide_submit_hide_css))
                  .show();
              });
            $('.hide-submit-text', form).remove();
        }
      }
    }
  };

})(jQuery, Drupal, window, this.document);
;
